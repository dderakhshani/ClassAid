<ion-header class="content-header ion-no-border" collapse="fade">
    <img alt="Avatar" [src]="book?.getImageUrl()" />
</ion-header>

<ion-content class="round-content flex-fill p-2 ">

    <ion-item>
        <ion-avatar slot="start">
            <img alt="Avatar" [src]="book?.getImageUrl()" />
        </ion-avatar>
        <ion-label>
            <h3> {{lesson?.name}}</h3>
            <p>
                {{book.name}}
            </p>
        </ion-label>
    </ion-item>

    <div class="d-flex justify-content-center p-2">
        <ion-segment [scrollable]="true" value="home" mode="ios">
            <ion-segment-button value="reminder" id="open-reminder">
                <ion-icon name="alarm-outline" class="text-info"></ion-icon>
                <ion-label>یادآور</ion-label>
            </ion-segment-button>
            <ion-segment-button value="assignment" class="text-success">
                <ion-icon name="library-outline"></ion-icon>
                <ion-label>تکلیف</ion-label>
            </ion-segment-button>
            <ion-segment-button value="test" class="text-danger">
                <ion-icon name="bar-chart-outline"></ion-icon>
                <ion-label>آزمون</ion-label>
            </ion-segment-button>
            <ion-segment-button value="note" class="text-secondary" id="open-note">
                <ion-icon name="reader-outline"></ion-icon>
                <ion-label>یادداشت</ion-label>
            </ion-segment-button>
        </ion-segment>
    </div>
    <hr>
    <div>
        <ion-grid fixed>
            <ion-row>
                <ion-col size="4" *ngFor="let student of  studentsService.students$ | async" class="d-flex  align-items-stretch">
                    <ion-card class="student-card flex-fill" (click)="onStudentAction(student)" [color]="getColor(student)">
                        <ion-icon *ngIf="student.present" name="checkmark-circle" class="present" color="success"></ion-icon>

                        <div class="d-flex justify-content-center pt-2">
                            <ion-avatar slot="start">
                                <img alt="Avatar-Student" [src]="student.getImageUrl()" />
                            </ion-avatar>
                        </div>

                        <ion-card-header class="p-2">
                            <ion-card-subtitle class="text-center">
                                {{student.fullName}}
                            </ion-card-subtitle>
                        </ion-card-header>
                        <ion-card-content class="p-2 pt-0 pb-0">
                            <ng-container *ngIf="student.present">
                                <ion-icon name="alarm-outline" class="text-info pe-1"></ion-icon>
                                <ion-icon name="book-outline" class="text-danger pe-1"></ion-icon>
                                <ion-icon name="reader-outline" class="text-warning pe-1"></ion-icon>
                            </ng-container>
                            <ion-badge color="danger" *ngIf="!student.present">غایب</ion-badge>

                        </ion-card-content>
                    </ion-card>
                </ion-col>

            </ion-row>
        </ion-grid>
    </div>

    <ion-modal #modal_note trigger="open-note" [presentingElement]="presentingElement">
        <ng-template>
            <app-note [modal]="modal_note"></app-note>
        </ng-template>
    </ion-modal>

    <ion-modal #modal_reminder trigger="open-reminder" [presentingElement]="presentingElement">
        <ng-template>
            <app-reminder [modal]="modal_reminder"></app-reminder>
        </ng-template>
    </ion-modal>


    <ion-modal #modal [isOpen]="isModalOpen" (didDismiss)="isModalOpen=false" [initialBreakpoint]="0.3" [breakpoints]="[0, 0.3]">
        <ng-template>

            <ion-content class="ion-padding">
                <ion-grid fixed>
                    <ion-row>
                        <ion-col size="6" class="p-2">
                            <ion-button fill="outline" color="primary" expand="block" class="action-button">
                                <div class="d-flex flex-column p-2">
                                    <ion-icon name="alarm-outline" size="large"></ion-icon>
                                    <ion-label class="mt-2"> یادآور</ion-label>
                                </div>

                            </ion-button>
                        </ion-col>
                        <ion-col size="6" class="p-2">
                            <ion-button fill="outline" (click)="onAssess()" color="danger" expand="block" class="action-button">
                                <div class="d-flex flex-column p-2">
                                    <ion-icon name="bar-chart-outline" size="large"></ion-icon>
                                    <ion-label class="mt-2"> ارزشیابی</ion-label>
                                </div>
                            </ion-button>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col size="6" class="p-2">
                            <ion-button fill="outline" color="secondary" expand="block" class="action-button">
                                <div class="d-flex flex-column p-2">
                                    <ion-icon name="star" size="large"></ion-icon>
                                    <ion-label class="mt-2"> امتیازدهی</ion-label>
                                </div>
                            </ion-button>
                        </ion-col>
                        <ion-col size="6" class="p-2">
                            <ion-button fill="outline" color="tertiary" expand="block" class="action-button">
                                <div class="d-flex flex-column p-2">
                                    <ion-icon name="reader-outline" size="large"></ion-icon>
                                    <ion-label class="mt-2"> یادداشت</ion-label>
                                </div>
                            </ion-button>
                        </ion-col>
                    </ion-row>
                </ion-grid>
            </ion-content>
        </ng-template>
    </ion-modal>
</ion-content>